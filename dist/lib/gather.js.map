{"version":3,"sources":["lib/gather.js"],"names":["_initialize","require","_botbuilder","_get","_shortid","_without","prompt","choices","randomId","_shortid2","default","choicesLeft","chosenSoFar","bot","dialog","_botbuilder2","SimpleDialog","session","results","choiceIndex","_get2","userSaidDone","length","console","log","endDialogWithResult","undefined","choice","_without2","Prompts","concat","_toConsumableArray"],"mappings":"oRAAA,IAAAA,aAAAC,QAAA,iBACAC,YAAAD,QAAA,+DACAE,KAAAF,QAAA,oDACAG,SAAAH,QAAA,sDACAI,SAAAJ,QAAA,gFAJA,SAAAK,EAAAC,GAOE,GAAMC,IAAW,EAAAC,UAAAC,WAEbC,EAAcJ,EACdK,IASA,OAjBNZ,aAAAa,IAAAC,OAAAN,EAAA,GAAAO,cAAAL,QAAAM,aAAA,SAAAC,EAAAC,GAWI,GAAMC,IAAc,EAAAC,MAAAV,SAAI,iBAAkBQ,GACpCG,EAAeF,IAAgBR,EAAYW,MAIjD,IAfJC,QAAAC,IAAAZ,EAAAD,EAAAQ,GAeQE,EACF,MAAOJ,GAAQQ,oBAAoBb,EAGrC,IAAoBc,SAAhBP,EAA2B,CAC7B,GAAMQ,GAAShB,EAAYQ,EAE3BP,MAAAA,OAAAA,mBAAkBA,IAAae,IAC/BhB,GAAc,EAAAiB,UAAAlB,UAASiB,GAAShB,GAhBpC,MAoBEY,SAAQC,IAAIZ,EAAaD,GApBvBC,EAAcU,OAIVD,EAAeF,OAuBnBJ,aAAAL,QAAQmB,QAAQF,OAAOV,EAAS,oBAAhCa,OAAAC,mBAAsDpB,IAAa,UArBrEY,aAAAA,QAAQC,QAAIZ,OAAaD,EAAAA,KAAzBY,OAAAA,mBAAsCJ,IAAtC,UAiBSF,EAAQQ,oBAAoBb,MAdnCJ","file":"gather.js","sourcesContent":["import { bot } from '../initialize';\nimport builder from 'botbuilder';\nimport get from 'lodash/fp/get';\nimport shortid from 'shortid';\nimport without from 'lodash/fp/without';\n\nexport default (prompt, choices) => {\n  const randomId = shortid();\n\n  let choicesLeft = choices;\n  let chosenSoFar = [];\n\n  bot.dialog(randomId, new builder.SimpleDialog((session, results) => {\n    const choiceIndex = get('response.index', results);\n    const userSaidDone = choiceIndex === choicesLeft.length;\n\n    console.log(chosenSoFar, choicesLeft, choiceIndex);\n\n    if (userSaidDone) {\n      return session.endDialogWithResult(chosenSoFar);\n    }\n\n    if (choiceIndex !== undefined) {\n      const choice = choicesLeft[choiceIndex];\n      /* eslint-disable fp/no-mutation */\n      chosenSoFar = [...chosenSoFar, choice];\n      choicesLeft = without([choice], choicesLeft);\n      /* eslint-enable fp/no-mutation */\n    }\n\n    console.log(chosenSoFar, choicesLeft);\n\n    if (!choicesLeft.length) {\n      return session.endDialogWithResult(chosenSoFar);\n    }\n\n    return chosenSoFar.length ?\n      builder.Prompts.choice(session, 'Anything else?', [...choicesLeft, 'Nope']) :\n      builder.Prompts.choice(session, prompt, [...choicesLeft, 'None']);\n  }));\n\n  return randomId;\n};\n"]}